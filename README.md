# Origins

### Code for RPG Origins

---

### **Origins 1.0**

1.0 版本实现了**角色数据的查询** 、**初代的基本战斗流程**。

游戏角色以 Entity 类实现，具有姓名、生命值、攻击力、防御力、暴击值、命 中值、闪避值等属性，以及查询角色信息、修正生命值等方法。 Entity 父类下设计了 Hero 子类和 Monster 子类，分别表示玩家可操作的英雄与游戏内置的怪物。其中 Hero 子类具有 Attack 方法，调用该方法可实现战斗结算，调用时需传入双方对象作为参数，方法内分别根据双方的命中值与闪避值判定此次攻击是否被闪避、根据双方的攻击力与防御力判定此次攻击造成的伤害、根据发起攻击一方的暴击值判定是否造成暴击，结算完毕后方法会修正战斗双方的生命值。

攻击被闪避的判定方法为在 0 到受攻击一方的闪避值(如100)之间生成一个随机数(如70)，若该随机数大于发起攻击一方的命中值(如60)，则此次攻击被闪 避。

未被闪避的攻击伤害结算方式为:发起攻击一方的攻击力(如30)减去受攻击 一方的防御力(如25)的差值(即5)，该差值为此次攻击造成的伤害，若此次攻击造 成暴击，则该伤害翻倍(即10)。

攻击产生暴击的判定方法为在 0 到 300 之间生成一个随机数(如80)，若该随 机数小于发起攻击一方的暴击值(如100)，则此次攻击产生暴击。

经过多次重复测试， 1.0 版本的问题显而易见:

(1)计算闪避时需考虑的变量单一且重复，在角色设计相对平衡的环境中，容 易导致不同角色之间的闪避值与命中值相差不大，且闪避几率浮动较大，而 0.1 附近 的闪避几率与 0.5 附近的闪避几率的差距会导致完全不同的游戏体验;

(2)每次攻击都是仅对 Monster 类的某一对象造成单次伤害，即同一种怪物本 质上是同一个对象，对游戏的容量和角色的设计非常不利;

(3)战斗双方同时造成伤害，这不符合常理。设想若此次伤害会导致双方同时 死亡，则理应有一方先受到致命伤害，而对方会因此侥幸存活。所以应当引入战斗双 方的攻击次序。

---

### **Origins 2.0**

2.0 版本改进了 1.0 版本中的诸多问题，并进一步完善了框架。

新增及重构:

(1)玩家登录需输入玩家名字及密码，且密码可被永久性修改。

(2)玩家可保存读取进度，即使重新进入游戏再次登录角色，只要记录进度的 文本文件未被删除，则仍然可以读取进度恢复到上一次的状态。玩家也可选择“新的游 戏”选项来重新开始冒险，这将会给角色重新赋初值。

(3)新增“游客登录”选项，即不清楚玩家名字及其密码时，可通过游客登录体 验游戏，但是游客身份不能保存游戏进度，也不能修改密码(因为游客身份本身就不 存在密码......)

(4)Entity 类属性重构为名字、性别、生命、力量、敏捷、防御强度、体型 等。角色的生命将受其体型大小影响，决定的力量、敏捷、防御强度、体型同时影响 战斗的具体结算，这将更符合常理。如力量等属性的影响具体体现为修正值(如力量 修正)，通常修正值为该属性值(如15)减去 10 并除以 2 后的向下取整值(即2)， 特别地，体型修正值会有其独立的修正表。修正值会参与各项加权值的计算。

(5)Monster 类下分不同种族的怪物子类，这样可以在之后版本引入技能特性 概念后，让不同怪物子类实现不同的技能特性接又，这样可以真正实现怪物的多样 化。

(6)重新定义了战斗的发生。“发起攻击”选项实际为选择一种怪物作为攻击对 象，这会让系统生成一个该怪物的对象仅用于此次战斗。战斗的结束不再是一次双方 攻击的结束，而是战斗的任一方生命值归零。

(7)引入了战斗时攻击次序的概念:战斗中的每次攻击发生时，会进行一次攻 击次序的判断:优先加权值 =(1 到 20 的随机数)+(角色敏捷修正)，根据双方的 优先加权值来结算此次攻击造成伤害的先后。

(8)攻击被闪避的判断:攻击方命中加权值 =(1 到 20 的随机数)+(角色力 量修正)+(角色体型修正);防守方闪避加权值 =(角色防御强度)+(角色敏捷修 正)+(角色体型修正)。若防守方闪避加权值大于攻击方命中加权值，则此次攻击 被闪避。

(9)攻击造成的伤害为攻击方的力量值，且移除了暴击的概念。
